//
// TreesRadio Firebase security definitions
// Compiles with firebase-bolt
// https://www.firebase.com/docs/security/bolt/index.html
//



////////////////////////////////////////////////////////////////
// GLOBAL FUNCTIONS
////////////////////////////////////////////////////////////////
isUser(uid) { auth != null && auth.uid == uid }


////////////////////////////////////////////////////////////////
// MAIN PATH
////////////////////////////////////////////////////////////////
path / {

}

path /_admin {
  read() = true;
}

path /backend/chatlock {
  read() = true;
}

////////////////////////////////////////////////////////////////
// CHAT
////////////////////////////////////////////////////////////////

path /chat {
  read() = true;
}

////////////////////////////////////////////////////////////////
// PLAYLISTS
////////////////////////////////////////////////////////////////
type Playlist {
  entries: Object,
  key: Any,
  name: String
}

path /playlists/{$uid} {
  read() = isUser($uid);
  write() = isUser($uid);
}

////////////////////////////////////////////////////////////////
// PLAYING MEDIA
////////////////////////////////////////////////////////////////

path /playing_media {
  read() = true;
}

////////////////////////////////////////////////////////////////
// PRESENCE
////////////////////////////////////////////////////////////////

path /presence {
  read() = true;
}

path /presence/{$username} {
  write() = isUser(newData.child('uid').val()) || isUser(data.child('uid').val());
}

////////////////////////////////////////////////////////////////
// USERS
////////////////////////////////////////////////////////////////

path /users/{$uid} {
  read() = true;
}

path /users/{$uid}/private {
  read() = isUser($uid);
}

path /moderator {
  read() = true;
}

path /bans {
  read() = true;
}

////////////////////////////////////////////////////////////////
// WAITLIST
////////////////////////////////////////////////////////////////

//type WaitlistTask {
//  channel: String,
//  thumb: String,
//  title: String,
//  uid: String,
//  url: String,
//  user: String,
//  avatar: String | Null
//}

path /waitlist/tasks {
  read() = true;
}
